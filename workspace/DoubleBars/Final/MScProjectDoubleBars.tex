\documentclass[a4paper,12pt]{article}
\usepackage{latexsym}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{float}
\usepackage{natbib}
\usepackage{listings}
\usepackage[skip=0pt]{caption}
\graphicspath{{./}}
\DeclareGraphicsExtensions{.eps}
\author{Howard Kinsman}
\title{MSc Project - Modelling a Double-Barred Galaxy as a Double Binary}
\begin{document}
\maketitle
\begin{abstract}
A brief literature review of double-barred galaxies and N-body simulations followed by an attempt at modelling a double-barred galaxy using a 4-body simulation of a double binary.  The aim of the project was to
find orbital resonances which may be responsible for the stability of double-barred galaxies and attempt at verifying the calculations carried out by \cite{garzon}. 
A 1:21 resonance was found but this is not representative of the observed pattern speeds of nested bars.
\end{abstract}
\section{Introduction}
\subsection{Double-Barred Galaxies} 
Double-barred galaxies, where a smaller inner bar is nested inside a larger outer bar, were first observed in 1975 by de Vaucouleurs \citep{vaucouleurs}, however it was only in the 1990s that double-barred galaxies
were recognised as being a distinct category of galaxies. The current estimates of double-barred galaxy frequencies are $\approx30\%$ of barred galaxies and $\approx20\%$ of all galaxies \citep{erwin3}.
\cite{erwin2} surveyed 38 barred galaxies and found a total of 10 double-barred galaxies with no preference for Hubble type. He found that inner bars were about 12\% the size of the outer bars with
semi-major axes from $\approx250$pc to 1 kpc. Secondary bars probably rotate independently of, but in the same direction as their associated primary bars \citep{erwin2}.
\cite{erwin1} believe that inner bars probably rotate independently of their outer bars and suggest that they are relatively long-lived structures.
Inner bar size has been found to correlate slightly with outer bar size \citep{erwin3}. The median size ratio is $\approx0.12$ with an upper limit of $\approx0.25$ which is consistent with the theory that
inner bars cannot be too large without disrupting the orbit of the outer bar.

\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./eso0128d.eps}
\caption{This is a schematic drawing of the various components of a double-barred galaxy. Credit: ESO}
\label{fig:doublepic}
\end{figure}

It has been suggested that nested bars may provide a mechanism for fuelling active galactic nuclei \citep{shlosman} however more recently, \citep{erwin3}, it was found that inner bars only play a minor role in this 
activity. \cite{erwin1} compared single and double-barred galaxies and found that there was no significant difference in nuclear activity. To investigate this theory further \cite{lorenzo1} carried out a 
study of NGC 357. This study aimed to present the first detailed morphological, kinematical and stellar population analysis of the bulge, inner and outer bars of a double-barred galaxy. They concluded that
the bulge and inner bar show similar stellar population properties whilst the outer bar was less metal-rich. This result implied that, for the case of NGC 357, the outer bar was formed in a shorter time-scale than
the inner structures and so disagrees with traditional idea that gas flown along the outer structure triggers star formation causing the formation of the inner structure. This was strengthened by a further study of
four double-barred galaxies by \cite{lorenzo2} where they concluded that the stellar populations of inner bars are younger and more metal-rich than the outer bars. This suggests that at present inner bars play a
moderate or even minor role in the morphological evolution of double-barred galaxies \citep{lorenzo2}.

Through the use of computer modelling \cite{saha} showed that double bars can form without gas in a dark matter dominated halo. They produced a model where the inner bar was rotating at almost as slowly as the 
outer bar. The route to the formation of double bars maybe very different to that of a single bar.
%\citep{moiseev}

\subsection{N-Body Simulations and the Four-Body Problem}
Studies of three or more bodies interacting gravitationally dates back to the time of Newton. However, it is only with the widespread use of computers that orbits of more than three bodies have been extensively studied. Today
N-body simulations are an essential tool in the study of solar system dynamics and galactic dynamics. The orbit-integration problems we have to address
vary in complexity from following a single particle in a given, smooth galactic potential, to tens of thousands of interacting stars in a globular cluster, to billions of dark-matter particles in a 
simulation of cosmological clustering \citep{binney}. Celestial mechanics during the preceding centuries has mainly focused on the three-body problem
due to the complexities involved in adding more bodies. It is estimated that within the Milky Way approximately two thirds of all stars exist in binary systems and a further one fifth of these are in triple systems whilst a
further fifth still exist in systems with more than three bodies \citep{steves}. \cite{steves} estimate that $\approx2\times10^9$ quadruple systems exist in the Milky Way galaxy. They found that quadruple systems exist in two
forms: a double binary or linear.

The classical equations of motion for an N-body problem are:
\begin{equation}
m_i\mathbf{\ddot{r}}=\sum_{i\neq{j}}\frac{{m_i}{m_j}}{r^3_{ij}}\mathbf{r_{ij}}
\qquad
i=1,2,3...
\end{equation}
where $\mathbf{r_i}=\left(x_i,y_i\right)$ and $\mathbf{r_{ij}}=\mathbf{r_j}-\mathbf{r_i}$. 
The units have been selected so that the gravitational constant (G) is equal to one. In simulations, it is natural to choose units where G = 1 and the units of length and mass are conventionally chosen
so that the total mass of the system is M = 1 \citep{heggie}.

The four-body problem, specifically, has been studied extensively by \cite{steves}. Here they model four equal mass bodies orbiting in circular coplanar orbits. This model they term the Caledonian problem, because
their research is being carried out at Glasgow Caledonian University.
Approximately a century ago the Copenhagen problem was studied extensively in Copenhagen which consisted of a three-body problem: two equal mass bodies and an infinitesimally small test particle. \cite{szell} also
studied the Caledonian problem and found that the stability of the system is dependent upon a constant termed the Szebehely constant. The Caledonian Symmetric Double Binary Problem (CSDBP) is relevant in 
studying the stability and evolution of symmetric quadruple stellar clusters and exoplanetary systems of two planets orbiting a binary pair of stars \citep{alvarez}.

Methods for the study of N-body simulations have changed considerably over the years. In a study of N-body simulations \cite{trenti} mentions a pioneering attempt by Holmberg in 1941 which used 
light bulbs and galvanometers to track the evolution of 37 particles. However, it wasn't until the early seventies and the advent of computers that this field really got started. 
Nowadays simulations can up to a million particles \citep{heggie} which is of particular relevance to the study of globular
clusters. I refer the reader to \cite{aarseth} for much more detailed explanation of the field of N-body simulations.

\subsection{Orbits, Loops, Resonances and Double-Barred Galaxy Simulations}
Double-barred galaxy simulations and models have taken many forms. \cite{du1} explored the formation and evolution of double-barred galaxies (which is not very well understood) by showing that a dynamically
cool inner disk embedded in a hotter outer disk can generate a secondary bar while the outer disk forms a large-scale primary bar. \cite{macie8} used hydrodynamical simulations to study gas inflow in barred galaxies
and the effect this has on secondary bars. They concluded that the secondary bar can prevent, rather than enhance, the inflow. More recently, \cite{debattista} used collisionless N-body simulations to show
that inner bars can form spontaneously without requiring gas. They also found that secondary bars rotate faster that primary bars and that the secondary bars pulsate. This is considered further in the Discussion.

In an attempt to explain the dynamics of the orbits of nested bars \cite{macie7} introduced the concept of `loops'. They wanted to investigate how two independently rotating bars can maintain
themselves as gravitating systems. A gravitational potential consisting of two concentric bi-symmetric bars that are independently rotating is not stationary in any reference frame \citep{macie7}. In the potential
of a single bar particles would stay on a stable closed periodic orbit but with nested bars orbits will not be closed because the particles would be experience two separate forces. The `loop' therefore was
introduced as an extension of the concept of orbit. Particles in a `loop' would return to their original positions every time the bars come back to the same relative orientation \citep{macie7}. This lead to
the conclusion that loops supporting the inner bar are thicker with parallel bars and thinner with perpendicular bars \citep{macie3}. This also suggests that the two bars do not rotate through each other as rigid bodies
but the inner bar should pulsate and that the bars should spend more time nearly orthogonal\citep{macie3}. These predictions were confirmed by \cite{debattista} and \cite{shen1}. 
This was further confirmed by \cite{macie5} who found
that the inner bar should end well within its co-rotation radius and that the inner bar extends further out for lower pattern speeds than higher ones; the inner bar pulsates; and that the angular velocity of the inner
bar is not uniform and that faster inner bars rotate more coherently.

\cite{wozniak} also carried out double-barred galaxy simulations and achieved long-lived inner bars lasting for up to 7 Gyr. These were N-body/hydrodynamical simulations. He found that the two bar lengths, ratio of
pattern speeds, as well as the age of the inner stellar bar populations in the simulations matched well with observations. He concluded that because, unlike previous simulations, there was no overlap between primary bar 
inner Lindblad resonance (ILR) and the inner bar co-rotation (CR) or any kind of resonance overlap, then some other kind of mechanism must feed the central waves \citep{wozniak}. It is suggested that star 
formation may be responsible for bringing energy into the inner bar.

\cite{garzon} studied the dynamical evolution of two isolated bars, within the same galaxy, under their mutual gravitational interaction. They considered two cases purely analytically: rotation of rigid bodies and
rotation of deformable rotation. They found that the bars oscillate in size according to the relative angle between the bars. This is broadly in agreement with \cite{debattista}.
What follows is an attempt to verify the calculations in \cite{garzon} but using a simpler model of a double-barred galaxy using a double binary.

\newpage
\section{Methods}
The model was created using OdeInt from Numerical Recipes \citep{press}. OdeInt was first converted to Fortran 90 for this purpose.
Fortran 90 was selected as the language of choice in order to avoid the fixed line limitations of Fortran 77.
OdeInt performs integration using the Runge-Kutta method. The Runge-Kutta method is an extension of the Euler method of solving differential equations. However the Euler method
is an example of first-order integration whilst Runge-Kutta is second and higher order and so is much more accurate. The OdeInt uses a subroutine called RK4 which utilizes fourth-order Runge-Kutta integration.
It also uses a technique known as adaptive step-size. This involves adjusting the size of the integration steps to ensure the same level of accuracy however rapidly the function being integrated changes.
Many small steps should tiptoe through treacherous terrain, while a few great strides should speed through smooth uninteresting countryside \citep{press}.

For a four-body problem, Equation 1 results in the following:
\begin{equation}
\ddot{\mathbf{r_1}}=\frac{m_2\mathbf{r}_{12}}{r^3_{12}}+\frac{m_3\mathbf{r}_{13}}{r^3_{13}}+\frac{m_4\mathbf{r}_{14}}{r^3_{14}}
\end{equation}
\begin{equation}
\ddot{\mathbf{r_2}}=\frac{m_1\mathbf{r}_{21}}{r^3_{21}}+\frac{m_3\mathbf{r}_{23}}{r^3_{23}}+\frac{m_4\mathbf{r}_{24}}{r^3_{24}}
\end{equation}
\begin{equation}
\ddot{\mathbf{r_3}}=\frac{m_1\mathbf{r}_{31}}{r^3_{31}}+\frac{m_2\mathbf{r}_{32}}{r^3_{32}}+\frac{m_4\mathbf{r}_{34}}{r^3_{34}}
\end{equation}
\begin{equation}
\ddot{\mathbf{r_4}}=\frac{m_1\mathbf{r}_{41}}{r^3_{41}}+\frac{m_2\mathbf{r}_{42}}{r^3_{42}}+\frac{m_3\mathbf{r}_{43}}{r^3_{43}}
\end{equation}
These equations of motion are second-order ordinary differential equations (ODEs) but any second-order ODE can be written as a system
of two coupled first-order ODEs. As there are four bodies in the system, and they all have x and y positional components, this gives eight second-order 
ODEs which leaves us with a total of sixteen simultaneous first-order ODEs to solve.
These equations were encoded into Fortran. 
A full code listing is supplied in a separate file.
\subsection{Initial Conditions}
As a starting point both the outer binary and inner binary were placed in circular orbits and tested separately and then combined to ensure a stable
starting point. The inner binary had an initial negligible mass.
The outer binary initial conditions were:
\begin{lstlisting}
m1=.5, m2=.5, x1=-.5, x2=.5, y1=0, y2=0,
vx1=0, vx2=0, vy1=-.5, vy2=.5
\end{lstlisting}
and for the inner binary:
\begin{lstlisting}
m3=.001, m4=.001, x3=-.001, x4=.001, y3=0, y4=0, 
vx3=0, vx4=0, vy3=-.5, vy4=.5
\end{lstlisting}
Plots of the two initial binaries are shown in Fig. \ref{fig:outerbinary} and 
\ref{fig:innerbinary}.
\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./2016results/outerbinary/Orbit.eps}
\caption{Outer Binary}
\label{fig:outerbinary}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./2016results/innerbinary/Orbit.eps}
\caption{Inner Binary}
\label{fig:innerbinary}
\end{figure}
The system was then perturbed by gradually increasing the mass of the inner binary. As the system became unstable the increasing mass of the inner binary 
was compensated for by increasing the velocity of the outer binary and also decreasing the velocity and increasing the binary 
separation of the inner binary. In many of the configurations the systems were inherently unstable and produced collisions with some 
or all of the bodies being ejected from the system. These were rejected and only `stable' configurations were considered.
Table \ref{tab:variables} shows the perturbations made to the system - only the variables in this table changed and all the other initial
conditions remained the same.
\begin{table}[ht!]
  \centering
  \caption{Configurations}
  \label{tab:variables}
  \begin{tabular}{ccccccccc}
   Config. & m3 & m4 & vy1 & vy2 & x3 & x4 & vy3 & vy4\\
    \hline
   1 & .001 & .001 & -.5 & .5 & -.001 & .001 & -.5 & .5\\
   2 & .002 & .002 & -.5 & .5 & -.001 & .001 & -.5 & .5\\
   3 & .003 & .003 & -.5 & .5 & -.001 & .001 & -.5 & .5\\
   4 & .004 & .004 & -.5 & .5 & -.004 & .004 & -.5 & .5\\
   5 & .004 & .004 & -.55 & .55 & -.004 & .004 & -.5 & .5\\
   6 & .004 & .004 & -.57 & .57 & -.004 & .004 & -.5 & .5\\
   7 & .005 & .005 & -.58 & .58 & -.005 & .005 & -.3 & .3\\
   8 & .005 & .005 & -.58 & .58 & -.005 & .005 & -.4 & .4\\
   9 & .005 & .005 & -.58 & .58 & -.005 & .005 & -.35 & .35\\
   10 & .006 & .006 & -.6 & .6 & -.006 & .006 & -.3 & .3\\
   11 & .025 & .025 & -.65 & .65 & -.02 & .02 & -.5 & .5\\
   12 & .025 & .025 & -.7 & .7 & -.025 & .025 & -.5 & .5\\
   13 & .03 & .03 & -.7 & .7 & -.03 & .03 &-.5 & .5\\
   14 & .035 & .035 & -.75 & .75 & -.04 & .04 &-.4 & .4\\
   15 & .04 & .04 & -.75 & .75 & -.045 & .045 &-.4 & .4\\
   16 & .05 & .05 & -.75 & .75 & -.045 & .045 &-.4 & .4\\
   17 & .05 & .05 & -.75 & .75 & -.05 & .05 &-.35 & .35\\
   18 & .05 & .05 & -.75 & .75 & -.05 & .05 &-.3 & .3\\
   19 & .06 & .06 & -.8 & .8 & -.06 & .06 &-.25 & .25\\
   20 & .08 & .08 & -.9 & .9 & -.08 & .08 &-.15 & .15\\
   21 & .09 & .09 & -.95 & .95 & -.09 & .09 &-.1 & .1\\
   22 & .1 & .1 & -1 & 1 & -.1 & .1 & -.05 & .05\\
   23 & .1 & .1 & -1 & 1 & -.1 & .1 & -.04 & .04\\
   24 & .1 & .1 & -1 & 1 & -.1 & .1 & -.03 & .03\\
   25 & .1 & .1 & -1 & 1 & -.1 & .1 & -.02 & .02\\
   26 & .12 & .12 & -1.05 & 1.05 & -.11 & .11 & -.015 & .015\\
   27 & .12 & .12 & -1.1 & 1.1 & -.11 & .11 & -.015 & .015\\
   28 & .12 & .12 & -1.1 & 1.1 & -.115 & .115 & -.015 & .015\\
   29 & .12 & .12 & -1.1 & 1.1 & -.12 & .12 & -.015 & .015\\
   30 & .1 & .1 & -1 & 1 & -.1 & .1 & -.1 & .1\\
   31 & .1 & .1 & -1 & 1 & -.102 & .102 & -.1 & .1\\
   31 & .1 & .1 & -1 & 1 & -.1021 & .1021 & -.1 & .1\\
  \end{tabular}
\end{table}
\clearpage
\section{Results}
As can be seen from Fig. \ref{fig:config1} even a negligible mass inner binary causes the outer binary to begin to separate and become less tightly bound.
Figures Fig. \ref{fig:config1} to \ref{fig:config32i} show plots of the double binary using the parameters given in Table \ref{tab:variables}.
As the mass of the inner binary increased the system became increasingly unstable and the effect on the outer binary became more pronounced.
Even the `stable' configurations listed in Table \ref{tab:variables} hold for only a few orbits.
Figs. \ref{fig:config1} and \ref{fig:config1i} show the initial orbits when the circular inner binary is placed within the outer binary. The placement of
the inner binary can clearly be seen to affect the orbit of the outer binary even though the inner binary mass is very low.
\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./2016results/stablebase/Orbit.eps}
\caption{Configuration 1}
\label{fig:config1}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./2016results/stablebase/Inner.eps}
\caption{Configuration 1 - Inner Bar}
\label{fig:config1i}
\end{figure}

Figs. \ref{fig:config2} to \ref{fig:config3i} show plots where just the mass of the inner binary has been gradually increased. Nothing else was changed.
By Fig. \ref{fig:config3i}, the inner binary has been pulled apart by the gravitational affect of the outer binary.
\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./2016results/002-5-001/Orbit.eps}
\caption{Configuration 2}
\label{fig:config2}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./2016results/002-5-001/Inner.eps}
\caption{Configuration 2 - Inner Bar}
\label{fig:config2i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./2016results/003-5-001/Orbit.eps}
\caption{Configuration 3}
\label{fig:config3}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=.9\textwidth]{./2016results/003-5-001/Inner.eps}
\caption{Configuration 3 - Inner Bar}
\label{fig:config3i}
\end{figure}

To counteract the effect of the increased mass of the inner binary in Figs. \ref{fig:config4} and \ref{fig:config4i} the initial separation of the 
inner binary has been increased by .003 to .004. This has a noticeable stabilising effect on the inner binary which has regained approximate circularity.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/004-5-004/Orbit.eps}
\caption{Configuration 4}
\label{fig:config4}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/004-5-004/Inner.eps}
\caption{Configuration 4 - Inner Bar}
\label{fig:config4i}
\end{figure}

In Figs. \ref{fig:config5} to \ref{fig:config10i} the initial velocity of the outer binary has also been gradually increased to also counteract the effect
of the increased mass of the inner binary. In order for these systems to be relatively stable the initial velocity of the inner binary was reduced. At this point 
both the inner and outer binaries had started to separate and the inner binary became increasingly elliptical.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/004-55-004/Orbit.eps}
\caption{Configuration 5}
\label{fig:config5}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/004-55-004/Inner.eps}
\caption{Configuration 5 - Inner Bar}
\label{fig:config5i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/004-57-004/Orbit.eps}
\caption{Configuration 6}
\label{fig:config6}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/004-57-004/Inner.eps}
\caption{Configuration 6 - Inner Bar}
\label{fig:config6i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/005-58-005-3/Orbit.eps}
\caption{Configuration 7}
\label{fig:config7}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/005-58-005-3/Inner.eps}
\caption{Configuration 7 - Inner Bar}
\label{fig:config7i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/005-58-005-4/Orbit.eps}
\caption{Configuration 8}
\label{fig:config8}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/005-58-005-4/Inner.eps}
\caption{Configuration 8 - Inner Bar}
\label{fig:config8i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/005-58-005-35/Orbit.eps}
\caption{Configuration 9}
\label{fig:config9}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/005-58-005-35/Inner.eps}
\caption{Configuration 9 - Inner Bar}
\label{fig:config9i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/006-6-006-3/Orbit.eps}
\caption{Configuration 10}
\label{fig:config10}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/006-6-006-3/Inner.eps}
\caption{Configuration 10 - Inner Bar}
\label{fig:config10i}
\end{figure}

In order to bring the orbits back into approximate circularity it was necessary to again increase the velocity of the inner binary. This is illustrated
in Figs. \ref{fig:config11} and \ref{fig:config11i}. The mass of the inner binary has also increased considerably from the previous configurations to .025.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/025-65-02/Orbit.eps}
\caption{Configuration 11}
\label{fig:config11}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2016results/025-65-02/Inner.eps}
\caption{Configuration 11 - Inner Bar}
\label{fig:config11i}
\end{figure}

Figs. \ref{fig:config12} to \ref{fig:config13i} show the mass of the inner binary being slowly increased with adjustments made to both velocity of outer binary
and separation of inner binary.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/025-7-025-5/Orbit.eps}
\caption{Configuration 12}
\label{fig:config12}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/025-7-025-5/Inner.eps}
\caption{Configuration 12 - Inner Bar}
\label{fig:config12i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/03-7-03-5/Orbit.eps}
\caption{Configuration 13}
\label{fig:config13}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/03-7-03-5/Inner.eps}
\caption{Configuration 13 - Inner Bar}
\label{fig:config13i}
\end{figure}

As the mass of the inner binary was increased, it became necessary to reduce the velocity of the inner binary, Figs. \ref{fig:config14} to \ref{fig:config15i}.
However, the inner binary was showing signs of increasingly chaotic orbits.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/035-75-04-4/Orbit.eps}
\caption{Configuration 14}
\label{fig:config14}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/035-75-04-4/Inner.eps}
\caption{Configuration 14 - Inner Bar}
\label{fig:config14i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/04-75-045-4/Orbit.eps}
\caption{Configuration 15}
\label{fig:config15}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/04-75-045-4/Inner.eps}
\caption{Configuration 15 - Inner Bar}
\label{fig:config15i}
\end{figure}

Whilst holding the mass of the inner binary at .05, the system showed signs of more stability if the velocity of the inner binary was further reduced, Figs. \ref{fig:config16} to \ref{fig:config18i}.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/05-75-045-4/Orbit.eps}
\caption{Configuration 16}
\label{fig:config16}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/05-75-045-4/Inner.eps}
\caption{Configuration 16 - Inner Bar}
\label{fig:config16i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/05-75-05-35/Orbit.eps}
\caption{Configuration 17}
\label{fig:config17}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/05-75-05-35/Inner.eps}
\caption{Configuration 17 - Inner Bar}
\label{fig:config17i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/05-75-05-3/Orbit.eps}
\caption{Configuration 18}
\label{fig:config18}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/05-75-05-3/Inner.eps}
\caption{Configuration 18 - Inner Bar}
\label{fig:config18i}
\end{figure}

Further reduction of the velocity of the inner binary allowed further increase of inner binary mass without losing stability, Figs. \ref{fig:config19} to \ref{fig:config21i}. The simulation is
now stable enough for the outer binary to complete one orbit and proceed with a second. It was found that by increasing the mass and separation of the inner binary by .01, and increasing the 
velocity of the outer binary by .05, whilst steadily reducing the velocity of the inner binary resulted in the fairly stable configurations shown here.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/06-8-06-25/Orbit.eps}
\caption{Configuration 19}
\label{fig:config19}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/06-8-06-25/Inner.eps}
\caption{Configuration 19 - Inner Bar}
\label{fig:config19i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/08-9-08-15/Orbit.eps}
\caption{Configuration 20}
\label{fig:config20}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/08-9-08-15/Inner.eps}
\caption{Configuration 20 - Inner Bar}
\label{fig:config20i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/09-95-09-1/Orbit.eps}
\caption{Configuration 21}
\label{fig:config21}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/09-95-09-1/Inner.eps}
\caption{Configuration 21 - Inner Bar}
\label{fig:config21i}
\end{figure}

With the mass of the inner binary now a quite considerable .1, the system showed more signs of stability if the velocity of the inner binary was further reduced, Figs. \ref{fig:config22} to \ref{fig:config25i}.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-05/Orbit.eps}
\caption{Configuration 22}
\label{fig:config22}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-05/Inner.eps}
\caption{Configuration 22 - Inner Bar}
\label{fig:config22i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-04/Orbit.eps}
\caption{Configuration 23}
\label{fig:config23}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-04/Inner.eps}
\caption{Configuration 23 - Inner Bar}
\label{fig:config23i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-03/Orbit.eps}
\caption{Configuration 24}
\label{fig:config24}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-03/Inner.eps}
\caption{Configuration 24 - Inner Bar}
\label{fig:config24i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-02/Orbit.eps}
\caption{Configuration 25}
\label{fig:config25}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-02/Inner.eps}
\caption{Configuration 25 - Inner Bar}
\label{fig:config25i}
\end{figure}

In Figs. \ref{fig:config26} to \ref{fig:config29i} the mass of the inner binary was increased to .12, and various adjustments made to inner separation, velocity and outer velocity to maintain stability. 
Both binaries, however, were now on highly elliptical orbits.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/12-105-11-015/Orbit.eps}
\caption{Configuration 26}
\label{fig:config26}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/12-105-11-015/Inner.eps}
\caption{Configuration 26 - Inner Bar}
\label{fig:config26i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/12-11-11-015/Orbit.eps}
\caption{Configuration 27}
\label{fig:config27}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/12-11-11-015/Inner.eps}
\caption{Configuration 27 - Inner Bar}
\label{fig:config27i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/12-11-115-015/Orbit.eps}
\caption{Configuration 28}
\label{fig:config28}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/12-11-115-015/Inner.eps}
\caption{Configuration 28 - Inner Bar}
\label{fig:config28i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/12-11-12-015/Orbit.eps}
\caption{Configuration 29}
\label{fig:config29}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/12-11-12-015/Inner.eps}
\caption{Configuration 29 - Inner Bar}
\label{fig:config29i}
\end{figure}

Having increased the mass of the inner binary to .12 on the previous three plots it was decided, that as inner bars are generally $\approx12\%$ of the mass of the outer bar, the mass of the inner binary could stay at .1
as this is 20\% of the mass of the outer binary, Figs. \ref{fig:config30} and \ref{fig:config30i}.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-1/Orbit.eps}
\caption{Configuration 30}
\label{fig:config30}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1-1/Inner.eps}
\caption{Configuration 30 - Inner Bar}
\label{fig:config30i}
\end{figure}

Finally, Figs. \ref{fig:config31} to \ref{fig:config32i} show the mass of the inner binary held at .1, but with minor adjustments made to the inner binary separation to enhance stability.
The final plot was very stable and allowed the simulation to run for far longer than all the other runs. This may be a resonance, please see Discussion. Although this final system was
very stable, even minor deviations from the initial conditions immediately resulted in destabilisation of the system, and chaos.
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-102-1/Orbit.eps}
\caption{Configuration 31}
\label{fig:config31}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-102-1/Inner.eps}
\caption{Configuration 31 - Inner Bar}
\label{fig:config31i}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1021-1/Orbit.eps}
\caption{Configuration 32}
\label{fig:config32}
\end{figure}
\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{./2017results/1-1-1021-1/Inner.eps}
\caption{Configuration 32 - Inner Bar}
\label{fig:config32i}
\end{figure}

\newpage
\section{Discussion}
The final three runs (configurations 30, 31, and 32) were by far the most stable. The orbital periods vary slightly with time so it is difficult to give accurate figures, so the 
periods of the first orbit were used to calculate the ratio of the periods between inner and outer binaries. The following table shows the periods of the two binaries together with the ratios of the corresponding periods.
\begin{table}[ht!]
  \centering
  \caption{Periods}
  \label{tab:periods}
  \begin{tabular}{ccccc}
   Config. & Inner & Outer & Ratio & Length of simulation\\
    \hline
   30 & .51 & 11.56 & 1:22.7 & 25\\
   31 & .54 & 11.5 & 1:21.3 & 25\\
   32 & .55 & 11.5 & 1:20.9 & 35\\
  \end{tabular}
\end{table}

Configuration 32 was by far the longest running simulation showing almost three complete orbits of the outer binary and many orbits of the inner binary. It showed no signs of destabilising and the 
simulation only ended because of a `Step size underflow' in the integrator. This error occurs when the adaptive step-size becomes too small and the integrator is effectively not making any
progress with the integration and so ends the simulation. The data shows that as the periodic ratios tends towards 1:21 the system considerably stabilises. 1:21 could therefore possibly be an orbital resonance. 
Attempts at modifying the initial conditions of configuration 32 even slightly resulted in chaotic systems. The concept of a resonance is very familiar to us all: pushing someone on a playground swing at its natural
frequency will rapidly increase the swing amplitude \citep{malhotra}. Resonances occur naturally in the Solar system and there are three main types of resonance: spin-orbit, secular and mean motion \citep{malhotra}.
The most obvious example of a spin-orbit resonance is the Earth/Moon system where the Moon is spin-locked and only one side of the Moon is visible from the Earth. Secular resonances occur where the precession of two
orbits are synchronised. However, the 1:21 resonance, is an example of a mean-motion resonance where the orbital period of two bodies are close to a ratio of small integer \citep{malhotra}. Orbital resonances
generally results in destabilising a system however occasionally they may be stable and remain in resonance.
In the standard model of double-barred galaxies \citep{macie7} it is assumed that resonant coupling between bars is present: CR of the inner bar coincides with the ILR of the outer bar. Although \cite{macie4} 
found that resonant coupling between the bars may not be the dominant factor reducing chaos in the system.

Unfortunately, a 1:21 resonance doesn't represent the observational data of double-barred galaxies. \cite{font} found that the inner bar rotates more rapidly than the outer bar by a factor between 3.3 and 3.6.
Whilst \cite{macie4} predicted values for the ratio of bar angular rates between 1.6 and 2.7. With these studies in mind it may be worthwhile exploring the double binary model further and searching for stable
resonances around the 1:2 or 1:3 parameter space - see next section. A comparison with the calculations carried out by \cite{garzon} was not completed because the results here seem to be dominated by free
oscillations rather than forced oscillations generated by the inner bar \citep{macie1}.

\subsection{Future Work}
As time constraints prevented the Garzon comparison from being carried out, a future project would need to minimise the free oscillations in order to compare it with Garzon's prediction.
As this system has a multidimensional parameter space, finding stable configurations was very time consuming. I suggest further studies in this area try to automate this process.
It may be possible for an automated process to automatically reject systems in which there are collisions, or if any of the bodies exit the system, or if the system fails 
to persist for a certain number of orbits. In this way, it may be possible to find further orbital resonances.

\newpage
\begin{thebibliography}{1}
\bibitem[Aarseth(2003)]{aarseth}Aarseth, S., Gravitational N-Body Simulations, 2003, Cambridge University Press
\bibitem[Alvarez-Ramirez and Medina(2014)]{alvarez}Alvarez-Ramirez, M., Medina, M., A Review of the Planar Caledonian Four-Body Problem, 2014
\bibitem[Binney and Tremaine(2008)]{binney}Binney, J., Tremaine, S., Galactic Dynamics, 2008, Princeton University Press
\bibitem[de Vaucouleurs(1975)]{vaucouleurs}de Vaucouleurs, G., 1975, ApJS,29, 193
\bibitem[Debattista and Shen(2007)]{debattista}Debattista, V., Shen, J., Long-Lived Double-Barred Galaxies from Psuedobulges, 2007, The Astrophysical Journal, 654: L127–L130, 2007 January 10
\bibitem[Du et. al.(2015)]{du1}Du, M., Shen, J., Debattista, V., Forming Double-Barred Galaxies from Dynamically Cool Inner Disks, 2015, The Astrophysical Journal, 804:139 (10pp), 2015 May 10 
\bibitem[Erwin(2003)]{erwin3}Erwin, P., Double-Barred Galaxies I. A Catalog of Barred Galaxies with Stellar Secondary Bars and Inner Disks, 2003, arXiv:astro-ph/0310806v2
\bibitem[Erwin(2011)]{erwin2}Erwin, P., Double-Barred Galaxies, 2011, Mem. S.A.It. Suppl. Vol. 18, 145
\bibitem[Erwin and Sparke(2002)]{erwin1}Erwin, P., Sparke, L., Double Bars, Inner Disks, and Nuclear Rings in Early-Type Disk Galaxies, 2002, The Astronomical Journal, 124:65–77, 2002 July
\bibitem[Font el. al.(2014)]{font}Font, J., Beckman, J., E., Zaragoza-Cardiel, J., Fathi, K., Epinat, B., Amram, P., The ratio of pattern speeds in double-barred galaxies, arXiv:1408.4274v1
\bibitem[Garzon and Lopez-Corredoira(2014)]{garzon}Garzon, F., Lopez-Corredoira, M., Dynamical evolution of two associated galactic bars, 2014, arXiv:1409.1916.v1
\bibitem[Heggie and Hut(2003)]{heggie}Heggie D., Hut, P., The Gravitational Million-Body Problem, 2003, Cambridge University Press
\bibitem[Lorenzo-Caceres et. al.(2002)]{lorenzo1}de Lorenzo-Caceres, A., Vazdekis, A., Aguerri, K., A., L., Corsini, E., M., Debattista, V., P., Constraining the formation of inner bars. Photometry, kinematics and stellar populations in NGC357⋆, 2002, arXiv:1111.1718v1
\bibitem[Lorenzo-Caceres et. al.(2013)]{lorenzo2}de Lorenzo-Caceres, A., Falcon-Barroso, J., Vazdekis, A., Distinct stellar populations in the inner bars of double-barred galaxies, 2013, arXiv:1302.5701v1
\bibitem[Maciejewski et. al.(2001)]{macie8}Maciejewski, W., Teuben, P., J., Sparke, L., S., Stone, J., M., Gas Inflow in Barred Galaxies - Effects of Secondary Bars, arXiv:astro-ph/0109431v1
\bibitem[Maciejewski(2008)]{macie3}Maciejewski, W., Orbits in corotating and counterrotating double bars, 2008, arXiv:0801.1471v1
\bibitem[Maciejewski(2017)]{macie1}Maciejewski, W., 11th September 2017 [email]
\bibitem[Maciejewski and Athanassoula(2008)]{macie4}Maciejewski, W., Athanassoula, A., Regular motions in double bars. II. Survey of trajectories and 23 models, 2008, arXiv:0805.3967v1
\bibitem[Maciejewski and Small(2010)]{macie5}Maciejewski, W., Small, E., Orbital Support of Fast and Slow Inner Bars in Double Barred Galaxies, 2010, arXiv:1006.4574v1
\bibitem[Maciejewski and Sparke(1998)]{macie6}Maciejewski, W., Sparke, L., Bars within Bars in Galaxies, 1998, arXiv:astro-ph/9812228v1
\bibitem[Maciejewski and Sparke(1999)]{macie7}Maciejewski, W., Sparke, L., Orbits Supporting Bars within Bars, 1999, arXiv:astro-ph/9911281v1
\bibitem[Malhotra(1998)]{malhotra}Malhotra, R., Orbital Resonances and Chaos in the Solar System, 1998, Solar system Formation and Evolution ASP Conference Series, Vol. 149, 1998
\bibitem[Moiseev(2001)]{moiseev}Moiseev, A., V., Velocity dispersion of stars and gas motion in double-barred galaxies, 2001, arXiv:astro-ph/0111220v1
\bibitem[Press et. al.(1992)]{press}Press, W., H., Teukolsky, S., A., Vetterling, W., T., Flannery, B., P., Numerical Recipes in Fortran 77 The Art of Scientific Computing, 2nd edition
\bibitem[Saha and Maciejewski(2013)]{saha}Saha, K., Maciejewski, W., Spontaneous formation of double bars in dark matter dominated galaxies, 2013, arXiv:1304.7108v1
\bibitem[Shen and Debattista(2008)]{shen1}Shen, J., Debattista, V., Long-lived double-barred galaxies in N-body simulations, 2008, Mem. S.A.It. Vol. 00, 169
\bibitem[Shen and Debattista(2009)]{shen2}Shen, J., Debattista, V., Observable Properties of Double-Barred Galaxies in N-Body Simulations, 2009, The Astrophysical Journal, 690:758–772, 2009 January 1
\bibitem[Shlosman et. al.(1989)]{shlosman}Shlosman, I., Frank, J., Begeman, M.,C., 1989, Nature, 338, 45
\bibitem[Steves and Roy(1998)]{steves}Steves, B., Roy, A., Some special restricted four-body problems-I. Modelling the Caledonian problem, 1998, Phrt. Spucx, Si., Vol. 46. No. I I /) 12, pp. 1465-1474, 1998
\bibitem[Szell et. al.(2004)]{szell}Szell, A., Erdi, B., Sandor, Zs., Steves, B., Chaotic and stable behaviour in the Caledonian Symmetric Four-Body Problem, 2004, Mon. Not. R. Astron. Soc. 347, 380Ð388 (2004)
\bibitem[Trenti and Hut(2008)]{trenti}Trenti, M., Hut, P., Gravitational N-body Simulations, 2008, arXiv:0806.3950v1
\bibitem[Wozniak(2015)]{wozniak}Wozniak, H., How can double-barred galaxies be long-lived?, 2015, A and A 575, A7 (2015)
\end{thebibliography}
\end{document}